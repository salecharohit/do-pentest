# Pentest Droplet

> Spin Up a simple droplet on Digital Ocean using Terraform and Ansible

Many times during pentest we need a server on cloud that would help us assist with scanning using tools like NMAP or simply a reverse lookup on Nginx.
Hence created this simple project which spins up a Droplet on Digital Ocean 

## Pre-Requisites 

1. Terraform
2. Digital Ocean Account Token

## Setup The Droplet

- Before setting up ensure that you have a file called `terraform.tfvars` under the `terraform` folder containing Digital Ocean personal token set as
```
do_token = "<token-value>"
```
- If you have a custom domain name then ensure to modify the same at [terraform/variables.tf](terraform/variables.tf#15) line 15 and [ansible/nginx/default.conf.j2](ansible/nginx/default.conf.j2#3) line 3. 
- If not then comment out  [terraform/main.tf](terraform/main.tf#46) line 46 and below

```bash
chmod +x *.sh
./setup.sh
```

[![asciicast](https://asciinema.org/a/402080.svg)](https://asciinema.org/a/402080)

## Destroy The Droplet

Once done , the droplet can be destroyed by executing the destroy.sh script

```bash
./destroy.sh
```
[![asciicast](https://asciinema.org/a/402081.svg)](https://asciinema.org/a/402081)

# DNS Configuration (Sub-domain Delegation)

If your having a registered domain name and would like to access this server on a sub-domain like sub.main.com then follow the steps below.

> Before you try the steps below please check whether your **Domain Provider supports Sub-Domain delegation.**

So I'm having my primary domain name rohitsalecha.com hosted on GoDaddy. 
I'd like to now setup pentest.rohitsalecha.com pointing to the droplet created using this terraform script.

Create a new DNS record of type "Nameserver". Add only the name of the sub-domain like "pentest" in the host field and in the points to field add the Nameserver DNS of Digital Ocean. Below screenshot summarises all.

ns1.digitalocean.com

ns2.digitalocean.com

ns3.digitalocean.com

![](dns_delegation.png)

No configuration needs to be done on DigitalOcean's side as that is being managed by the terraform script.

## Replace Domain Names

There are a few places in this script where you'll need to insert your own domain name 

- ansible/nginx/playbook.yml : domain_name variable
- terraform/variables.tf : domain_name variable OR add domain_name='your-domain' in terraform.tfvars

## Shameless Plug (Free $100 Credit for 60 Days !)

If you are new to Digital Ocean and are creating a new account then do use this referral code https://m.do.co/c/644b89dbd5d2 to get $100 Credits for 60 days !

## Reference

- Create your [Digital Ocean Token](https://www.digitalocean.com/docs/apis-clis/api/create-personal-access-token/)
